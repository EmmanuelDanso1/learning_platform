{% extends "index.html" %}
{% block content %}

<!-- ===========================================
   MAIN USER DASHBOARD SECTION
=========================================== -->
<div class="container text-center py-5">

    <!-- USER ICON -->
    <div class="mx-auto mb-4 d-flex justify-content-center align-items-center"
         style="width: 260px; height: 260px; border: 8px solid #000; border-radius: 50%;">
         
        {% if current_user.profile_pic %}
            <img src="{{ url_for('static',
                                  filename='uploads/users/user_' ~ current_user.id ~
                                  '/profile/' ~ current_user.profile_pic) }}"
                 alt="User Icon"
                 style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover;">
        {% else %}
            <img src="{{ url_for('static', filename='images/default-profile.webp') }}"
                 alt="User Icon"
                 style="width: 70%; height: 70%; object-fit: contain;">
        {% endif %}
    </div>

    <!-- Welcome Text -->
    <h1 class="fw-bold text-uppercase">WELCOME TO REALMINDX</h1>

    <h1 class="fw-bold text-uppercase" style="color:#0C2E60;">
        EDUCATION, {{ current_user.fullname }}
    </h1>

    <p class="mt-3 fw-semibold" style="letter-spacing:3px; color:#FFD000;">
        HOLISTIC LEARNING CONVENIENTLY FOR EVERY MIND
    </p>

    {% if not profile_complete %}
        <p class="mt-4 text-dark fw-semibold">
            PLEASE COMPLETE YOUR PROFILE TO SEE JOBS TAILORED JUST FOR YOU
        </p>

        <a href="{{ url_for('user.edit_profile') }}"
           class="btn fw-bold mt-3 px-5 py-3"
           style="background:#FFD000; border-radius:40px; font-size:1.3rem;">
            COMPLETE PROFILE
        </a>
    {% endif %}

</div>

<!-- ===========================================
   JOB LISTINGS SECTION
=========================================== -->
{% if profile_complete %}
<div class="container py-5">
    <h2 class="fw-bold text-uppercase text-center mb-4" style="color:#0C2E60;">
        Latest Job Opportunities
    </h2>

    {% if jobs|length == 0 %}
        <p class="text-center text-muted">No job postings available at the moment.</p>
    {% else %}
        <div class="row g-4">
            {% for job in jobs %}
            <div class="col-md-4">
                <div class="card shadow-sm h-100" style="border-radius:15px;">
                    <div class="card-body text-center">

                        <h4 class="fw-bold">{{ job.title }}</h4>
                        <p class="text-muted">{{ job.location }}</p>

                        <p class="mt-2">{{ job.description[:120] }}...</p>

                        <!-- APPLY / APPLIED BUTTON -->
                        {% if job.id in applied_jobs %}
                            <button class="btn btn-secondary mt-3 px-4 py-2" disabled>
                                Applied
                            </button>
                        {% else %}
                            <a href="{{ url_for('user.apply', job_id=job.id) }}"
                               class="btn mt-3 px-4 py-2 fw-bold"
                               style="background:#FFD000; border-radius:40px;">
                                Apply Now
                            </a>
                        {% endif %}

                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    {% endif %}
</div>
{% endif %}

{% endblock %}
