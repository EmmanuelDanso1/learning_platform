<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta-name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RealMindX | {% block title %}{% endblock %}</title>

  <link rel="icon" type="image/png" sizes="256x256" href="{{ url_for('static', filename='images/brain.png') }}">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">

  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"/>

  <link href="https://fonts.googleapis.com/css2?family=Arimo:wght@400;600&family=Montserrat:wght@500;600;700&display=swap"
        rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='main.css') }}">
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg custom-navbar fixed-top">
  <div class="container-fluid px-3">

    <!-- Logo -->
    <a class="navbar-brand d-flex align-items-center"
       href="{{ url_for('main.home') if not current_user.is_authenticated else url_for('user.users_dashboard') }}">
      <img src="{{ url_for('static', filename='images/real.jpg') }}" alt="RealmindX Logo" class="logo-img">
    </a>

    <!-- Mobile toggle -->
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>

    <!-- If user NOT logged in -->
    {% if not current_user.is_authenticated %}

    <div class="collapse navbar-collapse justify-content-center" id="navbarNav">
      <ul class="navbar-nav text-center">

        <li class="nav-item"><a class="nav-link" href="{{ url_for('main.home') }}">HOME</a></li>

        <!-- About -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="{{ url_for('main.about') }}" data-bs-toggle="dropdown">ABOUT</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="{{ url_for('main.about') }}#who">Who We Are</a></li>
            <li><a class="dropdown-item" href="{{ url_for('main.about') }}#mission">Our Mission</a></li>
            <li><a class="dropdown-item" href="{{ url_for('main.about') }}#vision">Our Vision</a></li>
            <li><a class="dropdown-item" href="{{ url_for('main.about') }}#goals">Our Goals</a></li>
            <li><a class="dropdown-item" href="{{ url_for('main.about') }}#choose-realmindx">Why Choose Us</a></li>
          </ul>
        </li>

        <!-- Services -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="{{ url_for('main.services') }}" data-bs-toggle="dropdown">SERVICES</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="{{ url_for('main.services') }}#teacher-recruitment">Teacher Recruitment</a></li>
            <li><a class="dropdown-item" href="{{ url_for('main.services') }}#teacher-development">Teacher Development</a></li>
            <li><a class="dropdown-item" href="{{ url_for('main.services') }}#school-structuring">School Structuring</a></li>
            <li><a class="dropdown-item" href="{{ url_for('main.services') }}#bookshop">Bookshop</a></li>
            <li><a class="dropdown-item" href="{{ url_for('main.services') }}#after-school">Tutoring</a></li>
            <li><a class="dropdown-item" href="{{ url_for('main.services') }}#special-education">Special Education</a></li>
            <li><a class="dropdown-item" href="{{ url_for('main.services') }}#secretarial">Secretarial</a></li>
            <li><a class="dropdown-item" href="{{ url_for('main.services') }}#consulting">Consulting</a></li>
          </ul>
        </li>

        <li class="nav-item"><a class="nav-link" href="{{ url_for('main.news') }}">NEWS</a></li>
        <li class="nav-item"><a class="nav-link" href="{{ url_for('main.gallery') }}">GALLERY</a></li>
        <li class="nav-item"><a class="nav-link" href="https://bookshop.realmindxgh.com" target="_blank">BOOKSHOP</a></li>
        <li class="nav-item"><a class="nav-link" href="{{ url_for('main.contact') }}">CONTACT</a></li>

        <!-- Teaching Jobs -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">TEACHING JOBS</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="{{ url_for('jobs.job_listings') }}">Job Posts</a></li>
            <li><a class="dropdown-item" href="{{ url_for('auth.user_login') }}">Login</a></li>
            <li><a class="dropdown-item" href="{{ url_for('auth.user_signup') }}">Sign Up</a></li>
          </ul>
        </li>
      </ul>

      <!-- Mobile DONATE -->
      <div class="text-center mt-3 d-lg-none">
        <a href="{{ url_for('donation.donate') }}" class="btn btn-warning btn-donate">DONATE</a>
      </div>
    </div>

    <!-- Desktop donate -->
    <div class="d-none d-lg-block">
      <a href="{{ url_for('donation.donate') }}" class="btn btn-warning btn-donate ms-2">DONATE</a>
    </div>

    <!-- END NOT AUTHENTICATED -->
    {% else %}

    <!-- ====================================== -->
    <!-- AUTHENTICATED USER NAVBAR (UPDATED) -->
    <!-- ====================================== -->

    <div class="collapse navbar-collapse justify-content-center" id="navbarNav">
      <ul class="navbar-nav text-center">

        <!-- Public links STILL show -->
        <li class="nav-item"><a class="nav-link" href="{{ url_for('main.home') }}">HOME</a></li>

        <!-- ABOUT -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">ABOUT</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="{{ url_for('main.about') }}#who">Who We Are</a></li>
            <li><a class="dropdown-item" href="{{ url_for('main.about') }}#mission">Our Mission</a></li>
            <li><a class="dropdown-item" href="{{ url_for('main.about') }}#vision">Our Vision</a></li>
            <li><a class="dropdown-item" href="{{ url_for('main.about') }}#goals">Our Goals</a></li>
            <li><a class="dropdown-item" href="{{ url_for('main.about') }}#choose-realmindx">Why Choose Us</a></li>
          </ul>
        </li>

        <!-- SERVICES -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">SERVICES</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="{{ url_for('main.services') }}#teacher-recruitment">Teacher Recruitment</a></li>
            <li><a class="dropdown-item" href="{{ url_for('main.services') }}#teacher-development">Teacher Development</a></li>
            <li><a class="dropdown-item" href="{{ url_for('main.services') }}#school-structuring">School Structuring</a></li>
            <li><a class="dropdown-item" href="{{ url_for('main.services') }}#bookshop">Bookshop</a></li>
            <li><a class="dropdown-item" href="{{ url_for('main.services') }}#after-school">Tutoring</a></li>
            <li><a class="dropdown-item" href="{{ url_for('main.services') }}#special-education">Special Education</a></li>
            <li><a class="dropdown-item" href="{{ url_for('main.services') }}#secretarial">Secretarial</a></li>
            <li><a class="dropdown-item" href="{{ url_for('main.services') }}#consulting">Consulting</a></li>
          </ul>
        </li>

        <li class="nav-item"><a class="nav-link" href="{{ url_for('main.news') }}">NEWS</a></li>
        <li class="nav-item"><a class="nav-link" href="{{ url_for('main.gallery') }}">GALLERY</a></li>
        <li class="nav-item"><a class="nav-link" href="https://bookshop.realmindxgh.com" target="_blank">BOOKSHOP</a></li>
        <li class="nav-item"><a class="nav-link" href="{{ url_for('main.contact') }}">CONTACT</a></li>

        <!-- Teaching Jobs when logged in -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">TEACHING JOBS</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="{{ url_for('jobs.job_listings') }}">Job Posts</a></li>
            <!-- <li><a class="dropdown-item" href="{{ url_for('user.users_dashboard') }}">Dashboard</a></li> -->
          </ul>
        </li>
      </ul>
    </div>

    <!-- Profile + Donate -->
    <ul class="navbar-nav ms-auto">

      <!-- Profile -->
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" id="userDropdown" role="button"
          data-bs-toggle="dropdown">
          
          {% if current_user.profile_pic %}
            <img src="{{ url_for('static',
                                  filename='uploads/users/user_' ~ current_user.id ~
                                            '/profile/' ~ current_user.profile_pic) }}"
                  width="38" height="38"
                  class="rounded-circle border"
                  style="object-fit: cover;">
          {% else %}
              <img src="{{ url_for('static', filename='images/default-profile.webp') }}"
                  width="38" height="38"
                  class="rounded-circle border"
                  style="object-fit: cover;">
          {% endif %}
        </a>

        <ul class="dropdown-menu dropdown-menu-end shadow">
          <li><a class="dropdown-item" href="{{ url_for('user.users_dashboard') }}">Dashboard</a></li>
          <li><a class="dropdown-item" href="{{ url_for('user.view_profile') }}">View Profile</a></li>
          <li><a class="dropdown-item" href="{{ url_for('user.edit_profile') }}">Edit Profile</a></li>
          <li><a class="dropdown-item" href="#">Apply for a Job</a></li>
          <li><a class="dropdown-item" href="#">Application History</a></li>
          <li><hr class="dropdown-divider"></li>
          <li><a class="dropdown-item text-danger fw-bold" href="{{ url_for('auth.logout') }}">Logout</a></li>
        </ul>
      </li>

      <!-- Donate -->
      <li class="nav-item d-none d-lg-block ms-2">
        <a href="{{ url_for('donation.donate') }}" class="btn btn-warning btn-donate">DONATE</a>
      </li>
    </ul>

    {% endif %}
  </div>
</nav>


{% if current_user.is_authenticated %}
<!-- Full-width yellow dashboard nav -->
<div class="user-dashboard-nav text-center">
  <div class="links-wrapper">
    <a href="{{ url_for('user.users_dashboard') }}" class="nav-link-divider">Dashboard</a>
    <a href="{{ url_for('user.view_profile') }}" class="nav-link-divider">View Profile</a>
    <a href="{{ url_for('user.edit_profile') }}" class="nav-link-divider">Edit Profile</a>
    <a href="#" class="nav-link-divider">Apply for a Job</a>
    <a href="#" class="nav-link-divider">Application History</a>
    <a href="#" class="nav-link-divider">Messages</a>
    <a href="{{ url_for('auth.logout') }}" class="nav-link-divider">Logout</a>
  </div>
</div>
{% endif %}


<!-- Main Content Area -->
{% block fullwidth %}{% endblock %}
<main class="container mt-5 pt-4">
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="alert alert-{{ category }} mt-3">{{ message }}</div>
      {% endfor %}
    {% endif %}
  {% endwith %}

  {% block content %}{% endblock %}
</main>
<br>

{% if not (current_user.is_authenticated and current_user.is_admin) %}
  {% include 'footer.html' %}
{% endif %}

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<a href="https://wa.link/q5rjtp" class="whatsapp-float" target="_blank"
   style="position: fixed; bottom: 20px; right: 20px; z-index: 9999;">
  <img src="{{ url_for('static', filename='images/whatsapp.png') }}" alt="WhatsApp" width="60">
</a>

</body>
</html>
