{% extends "admin/admin_base.html" %}
{% block title %}Edit Newsletter{% endblock %}

{% block content %}
<div class="container my-5">
  <h2>Edit Newsletter</h2>

  <!-- IMPORTANT: multipart/form-data for file upload -->
  <form method="POST" enctype="multipart/form-data">
    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">

    <!-- Title -->
    <div class="mb-3">
      <label class="form-label">Title</label>
      <input
        type="text"
        name="title"
        class="form-control"
        value="{{ newsletter.title }}"
        required>
    </div>

    <!-- Replace Image -->
    <div class="mb-3">
      <label class="form-label">Replace Image (optional)</label>
      <input
        type="file"
        name="newsletter_image"
        class="form-control"
        accept="image/*">

      {% if newsletter.image_filename %}
      <div class="mt-3">
        <p class="small text-muted mb-1">Current image:</p>
        <img
          src="{{ url_for('static', filename='uploads/newsletters/' ~ newsletter.image_filename) }}"
          class="img-fluid rounded border"
          style="max-height: 200px;">
      </div>
      {% endif %}
    </div>

    <!-- Content -->
    <div class="mb-3">
      <label class="form-label">Content</label>
      <textarea
        name="content"
        class="form-control"
        rows="8"
        required>{{ newsletter.content }}</textarea>
    </div>

    <!-- Actions -->
    <button type="submit" class="btn btn-primary">
      <i class="fas fa-save"></i> Update
    </button>
    <a href="{{ url_for('admin.list_newsletters') }}" class="btn btn-secondary">
      Cancel
    </a>
  </form>
</div>
{% endblock %}
